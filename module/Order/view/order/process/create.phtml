<?php
$form->setAttribute('action', $this->url('create-order'))
    ->prepare();
echo $this->form()->openTag($form);
?>

<?php
$fileTransferRequestFieldset = $form->get('file_transfer_request');
$userFieldset = $fileTransferRequestFieldset->get('user');
$logicalConnectionFieldset = $fileTransferRequestFieldset->get('logical_connection');
$serviceInvoicePositionBasicFieldset = $fileTransferRequestFieldset->get('service_invoice_position_basic');
$serviceInvoicePositionPersonalFieldset = $fileTransferRequestFieldset->get('service_invoice_position_personal');
$specificPhysicalConnectionsFieldset = $logicalConnectionFieldset->get('specific_physical_connections');

$specificEndpointCdAs400SourceFieldset = $specificPhysicalConnectionsFieldset->getFieldsets()[0]->get('basic_physical_connection')->get('specific_endpoint_source');
$specificEndpointCdAs400TargetFieldset = $specificPhysicalConnectionsFieldset->getFieldsets()[0]->get('basic_physical_connection')->get('specific_endpoint_target');
$basicEndpointCdSourceFieldset = $specificEndpointCdAs400SourceFieldset->get('basic_endpoint');
$basicEndpointCdTargetFieldset = $specificEndpointCdAs400TargetFieldset->get('basic_endpoint');
$applicationForSourceFieldset = $basicEndpointCdSourceFieldset->get('application');
$customerForSourceFieldset = $basicEndpointCdSourceFieldset->get('customer');
$serverForSourceFieldset = $basicEndpointCdSourceFieldset->get('server');
$applicationForTargetFieldset = $basicEndpointCdTargetFieldset->get('application');
$customerForTargetFieldset = $basicEndpointCdTargetFieldset->get('customer');
$serverForTargetFieldset = $basicEndpointCdTargetFieldset->get('server');
?>

<?php
// billing
$fieldgroupName = 'billing';
$fieldgroupCssClass = 'col-md-12';
$fieldgroupTitle = $this->translate('Billing');
$fieldgroupFormRows = [
    $this->formRow($fileTransferRequestFieldset->get('id')),
    '<div class="form-field-wrapper col-md-6">' . $this->formRow($fileTransferRequestFieldset->get('application_number')) . '</div>',
    $this->formRow($fileTransferRequestFieldset->get('change_number')),
    $this->formRow($logicalConnectionFieldset->get('type')),
    $this->formRow($serviceInvoicePositionBasicFieldset->get('number')),
    $this->formRow($userFieldset->get('id')),
    $this->formRow($userFieldset->get('username')),
    $this->formRow($serviceInvoicePositionPersonalFieldset->get('number'))
];
echo $this->partial('/partials/fieldgroup', 
    [
        'fieldgroupName' => $fieldgroupName,
        'fieldgroupCssClass' => $fieldgroupCssClass,
        'fieldgroupTitle' => $fieldgroupTitle,
        'formRows' => $fieldgroupFormRows
    ]);
?>

<?php
// endpoint source (basic settings)
$fieldgroupName = 'basic-endpoint-source';
$fieldgroupCssClass = 'col-md-6';
$fieldgroupTitle = $this->translate('Source - basic settings');
$fieldgroupFormRows = [
    $this->formRow($basicEndpointCdSourceFieldset->get('contact_person')),
    $this->formRadio($basicEndpointCdSourceFieldset->get('server_place')),
    $this->formRow($applicationForSourceFieldset->get('technical_short_name')),
    $this->formRow($customerForSourceFieldset->get('name')),
    $this->formRow($serverForSourceFieldset->get('name')),
];
echo $this->partial('/partials/fieldgroup', 
    [
        'fieldgroupName' => $fieldgroupName,
        'fieldgroupCssClass' => $fieldgroupCssClass,
        'fieldgroupTitle' => $fieldgroupTitle,
        'formRows' => $fieldgroupFormRows
    ]);
?>

<?php
// endpoint target (basic settings)
$fieldgroupName = 'basic-endpoint-target';
$fieldgroupCssClass = 'col-md-6';
$fieldgroupTitle = $this->translate('Target - basic settings');
$fieldgroupFormRows = [
    $this->formRow($basicEndpointCdTargetFieldset->get('contact_person')),
    $this->formRadio($basicEndpointCdTargetFieldset->get('server_place')),
    $this->formRow($applicationForTargetFieldset->get('technical_short_name')),
    $this->formRow($customerForTargetFieldset->get('name')),
    $this->formRow($serverForTargetFieldset->get('name')),
];
echo $this->partial('/partials/fieldgroup', 
    [
        'fieldgroupName' => $fieldgroupName,
        'fieldgroupCssClass' => $fieldgroupCssClass,
        'fieldgroupTitle' => $fieldgroupTitle,
        'formRows' => $fieldgroupFormRows
    ]);
?>

<?php
// endpoint source (specific settings)
$fieldgroupName = 'specific-endpoint-source';
$fieldgroupCssClass = 'col-md-6';
$fieldgroupTitle = $this->translate('Source - specific settings');
$fieldgroupFormRows = [
    $this->formRow($specificEndpointCdAs400SourceFieldset->get('username')),
];
echo $this->partial('/partials/fieldgroup', 
    [
        'fieldgroupName' => $fieldgroupName,
        'fieldgroupCssClass' => $fieldgroupCssClass,
        'fieldgroupTitle' => $fieldgroupTitle,
        'formRows' => $fieldgroupFormRows
    ]);
?>

<?php
// endpoint target (specific settings)
$fieldgroupName = 'specific-endpoint-target';
$fieldgroupCssClass = 'col-md-6';
$fieldgroupTitle = $this->translate('Target - specific settings');
$fieldgroupFormRows = [
    $this->formRow($specificEndpointCdAs400TargetFieldset->get('username')),
    $this->formRow($specificEndpointCdAs400TargetFieldset->get('folder')),
];
echo $this->partial('/partials/fieldgroup', 
    [
        'fieldgroupName' => $fieldgroupName,
        'fieldgroupCssClass' => $fieldgroupCssClass,
        'fieldgroupTitle' => $fieldgroupTitle,
        'formRows' => $fieldgroupFormRows
    ]);
?>

<?php
// physical connections
$fieldgroupName = 'physical_connection_cd';
$fieldgroupCssClass = 'col-md-12';
$fieldgroupTitle = $this->translate('Connection');
$fieldgroupFormRows = [
    $this->formRow($specificPhysicalConnectionsFieldset->getFieldsets()[0]->get('secure_plus'))
];
echo $this->partial('/partials/fieldgroup', 
    [
        'fieldgroupName' => $fieldgroupName,
        'fieldgroupCssClass' => $fieldgroupCssClass,
        'fieldgroupTitle' => $fieldgroupTitle,
        'formRows' => $fieldgroupFormRows
    ]);
?>

<div class="form-group">
    <div class="controls"><?php echo $this->formElement($form->get('submit')); ?></div>
</div>

<?php
echo $this->form()->closeTag();
?>
